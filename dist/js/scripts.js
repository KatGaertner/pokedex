"use strict";const pokemonRepo=function(){let e=[];function t(){return e}function n(e){e.forEach(function(e){var t;let n,i,a;t=e,n=document.getElementById("pokemon-list"),i=document.createElement("li"),(a=document.createElement("button")).innerText=t.name,a.classList.add("pokemon-list__item"),a.classList.add("list-group-item"),a.classList.add("btn"),a.classList.add("btn-light"),a.classList.add("btn-block"),a.setAttribute("data-toggle","modal"),a.setAttribute("data-target","#modal-container"),i.appendChild(a),n.appendChild(i),a.addEventListener("click",function(){modalHandler.updateDetails(t)})})}function i(){document.getElementById("loading-message").classList.add("hidden")}return{getAll:t,display:n,loadList:function t(){return document.getElementById("loading-message").classList.remove("hidden"),fetch("https://pokeapi.co/api/v2/pokemon/?limit=251").then(function(e){return e.json()}).then(function(t){t.results.forEach(function(t){var n;let i;i={name:(n=t).name.charAt(0).toUpperCase()+n.name.slice(1),detailsUrl:n.url,speciesUrl:n.url.split("pokemon").join("pokemon-species")},e.push(i)}),i()}).catch(function(e){console.error(e),i()})},loadDetails:function e(t){return fetch(t.detailsUrl).then(function(e){return e.json()}).then(function(e){var n,i;n=e,(i=t).imageUrl=n.sprites.front_default,i.imageUrlshiny=n.sprites.front_shiny,i.height=n.height,i.types=n.types.map(function(e){return e.type.name}),i.id=n.id}).catch(function(e){console.error(e)})},searchPokemon:function t(){var i;let a,o,l=(o=(i=document.getElementById("searchbar").value).toLowerCase(),e.filter(function(e){return -1!==e.name.toLowerCase().indexOf(o)}));l&&(function e(){let t=document.getElementById("pokemon-list"),n=document.querySelectorAll("#pokemon-list li");for(let i=0;i<n.length;i++)t.removeChild(n[i])}(),n(l),modalHandler.setCurrentList(l))},loadFlavorText:function e(t){return fetch(t.speciesUrl).then(function(e){return e.json()}).then(function(e){var n,i;let a;n=e,i=t,a=n.flavor_text_entries.filter(function(e){return"en"===e.language.name}).map(function(e){return e.flavor_text}),i.flavorText=a.map(function(e){return e.replace(/\s/g," ")})}).catch(function(e){console.error(e)})}}}(),modalHandler=function(){let e=document.getElementById("modal-container"),t=pokemonRepo.getAll(),n=null;function i(e){let t;$(".pkmn-data").each(function(e,t){t.innerText="\xa0"}),document.getElementById("pkmn-img")&&(document.getElementById("pkmn-img").src="dist/img/empty.png"),document.getElementById("pkmn-name")&&(document.getElementById("pkmn-name").innerText=e.name),(t=document.getElementById("modal-loading-message"))&&t.classList.remove("hidden"),e.height?(l(e),c()):pokemonRepo.loadDetails(e).then(function(){return pokemonRepo.loadFlavorText(e)}).then(function(){l(e),c()})}function a(){$("#modal-container").append('<div class="modal-dialog modal-dialog-centered modal-lg" role="document"><div class="modal-content"><div class="row align-items-center"><div class="col-12 col-md-8 offset-md-1 order-md-2" id="pkmn-modal"><div class="modal-header"><div class="modal-title"><div><h2 id="pkmn-name" class="pkmn-data"></h2><div id="modal-loading-message" class="spinner-border ml-3" role="status"><span class="sr-only">Loading...</span></div><p id="pkmn-id" class="modal-id pkmn-data"></p></div></div><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="modal-flex"><p><span id="pkmn-height" class="pkmn-data"></span><br><span id="pkmn-types" class="pkmn-data"></span></p><img src="dist/img/empty.png" id="pkmn-img" title="Pokemon sprite"></div><p id="pkmn-text" class="pkmn-data"></p></div></div><button class="btn btn-light modalButton mt-2 col-3 col-md-1 order-md-1 pt-3 pb-3" type="button" onclick="modalHandler.swipeLeft()" aria-label="previous Pokemon"><span aria-hidden="true"><img src="img/chevron-right.svg" class="icon turn180"></span></button><button class="btn btn-light modalButton mt-2 col-3 col-md-1 order-md-3 offset-6 offset-md-1 pt-3 pb-3" type="button" onclick="modalHandler.swipeRight()" aria-label="next Pokemon"><span aria-hidden="true"><img src="img/chevron-right.svg" class="icon"></span></button></div></div></div>')}function o(e,t){var n,i;let a=t.types.join(", "),o,l=(o=(n=t).imageUrl,4096*Math.random()<1&&(o=n.imageUrlshiny),o),d=Math.floor(Math.random()*(i=t).flavorText.length);e.getElementById("pkmn-name").innerText=t.name,e.getElementById("pkmn-id").innerText=["#",t.id].join(""),e.getElementById("pkmn-height").innerText=["Height: ",t.height].join(""),e.getElementById("pkmn-types").innerText=["Types: ",a].join(""),e.getElementById("pkmn-img").src=l,e.getElementById("pkmn-text").innerText=t.flavorText[d]}function l(i){var l;if(n=t.indexOf(i),e.innerHTML="","content"in document.createElement("template")){let s=document.getElementById("my-template"),r=s.content.cloneNode(!0);o(r,i),e.append(r)}else a(),o(document,i);let m,c;l=i,m=l.types.map(function(e){return d[e]}),1===m.length&&(m[1]=m[0]),c="#eeeeee",document.getElementById("pkmn-modal").style.background=["linear-gradient(",c,", ",c,") padding-box, linear-gradient(160deg, ",m[0],", ",m[1],") border-box"].join("")}let d={normal:"#A8A77A",fire:"#EE8130",water:"#6390F0",electric:"#F7D02C",grass:"#7AC74C",ice:"#96D9D6",fighting:"#C22E28",poison:"#A33EA1",ground:"#E2BF65",flying:"#A98FF3",psychic:"#F95587",bug:"#A6B91A",rock:"#B6A136",ghost:"#735797",dragon:"#6F35FC",dark:"#705746",steel:"#B7B7CE",fairy:"#D685AD"};function s(){let e=n-1,a=t[e];t[e]&&i(a)}function r(){let e=n+1,a=t[e];t[e]&&i(a)}function m(e){t=e}function c(){document.getElementById("modal-loading-message").classList.add("hidden")}return{addInitialEventListeners:function t(){document.addEventListener("keydown",function(t){e.classList.contains("show")&&("Escape"===t.key?$("#modal-container").modal("hide"):"ArrowLeft"===t.key||"Left"===t.key?s():("ArrowRight"===t.key||"Right"===t.key)&&r())})},updateDetails:i,createModalContent:a,swipeLeft:s,swipeRight:r,setCurrentList:m}}();pokemonRepo.loadList().then(function(){modalHandler.addInitialEventListeners(),pokemonRepo.display(pokemonRepo.getAll())});